//----------------------------------------------------------------------
//	Copyright (C) 2020-present Matias N. Goldberg ("dark_sylinc")
//  Under MIT License
//  This file is part of Yangen.
//----------------------------------------------------------------------

#pragma once

/**
@file
Subclass of PcgPanel, which is generated by wxFormBuilder.
*/

#include "OgrePrerequisites.h"

#include "OgreVector2.h"

#include "../../src/Autogenerated/wxYangen.h"

#include "Yangen/YangenManager.h"

#include "Helpers/LinkedWidgets.h"

#include <map>

//// end generated include

namespace Ogre
{
	class YangenManager;
}  // namespace Ogre

class YangenWindowImpl;
class ConfigReader;

/** Implementing PcgPanel */
class TexturePanelImpl : public TexturePanel
{
protected:
	struct NamedPreset
	{
		wxString                    name;
		Ogre::YangenManager::Preset preset;
		NamedPreset( const wxString &_name, const Ogre::YangenManager::Preset &_preset );
	};

	bool mInitializing;
	bool m_isInCustomPreset;

	std::map<wxSlider *, ConversionBase *>   m_sliderToTextCtrlMap;
	std::map<wxTextCtrl *, ConversionBase *> m_textCtrlToSliderMap;
	std::map<wxSlider *, ConvertPair *>      m_pairSlidersToTextCtrls;
	std::map<wxTextCtrl *, ConvertPair *>    m_pairTextCtrlsToSliders;

	std::vector<NamedPreset> m_presets;

	Ogre::YangenManager *m_yangenManager;

	void fillPresetsMap();
	void saveCustomPreset();

	void mapSliderAndTextCtrl( ConversionBase *converter );
	void mapSliderAndTextCtrl( ConversionBase *converter, float newDefault, bool bSetDefault = true );
	void mapSliderAndTextCtrl( ConvertPair *pair );
	void mapSliderAndTextCtrl( ConvertPair *pair, float minDefault, float maxDefault,
							   bool bSetDefault = true );

	float getValueFrom( wxTextCtrl *textCtrl, float defaultValue ) const;

	// Handlers for PcgPanel events.
	virtual void OnScroll( wxScrollEvent &event );
	void         OnCheckBox( wxCommandEvent &event );
	virtual void OnText( wxCommandEvent &event );
	virtual void OnChoice( wxCommandEvent &event );
	virtual void OnButtonClick( wxCommandEvent &event );

	void valueUpdated( wxTextCtrl *textCtrl );

public:
	/** Constructor */
	TexturePanelImpl( wxWindow *parent, Ogre::YangenManager *yangenManager );
	~TexturePanelImpl();
	//// end generated class members

	void dumpPresetToClipboard();

	wxScrolledWindow *getScrolledWindow() const { return m_scrolledWindow2; }
};
